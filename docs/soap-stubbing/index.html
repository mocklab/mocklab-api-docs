

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>How to: Stub a SOAP response - MockLab</title>







<meta name="description" content="Stubbing SOAP responses">

<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="MockLab">
<meta property="og:title" content="How to: Stub a SOAP response">




  <meta property="og:description" content="Stubbing SOAP responses">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-09-13T09:11:52+01:00">
  
    <link rel="next" href="/docs/stubbing/" title="Stubbing responses">
  
  
    <link rel="prev" href="/docs/response-templating/" title="Response Templating">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="MockLab Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!--<link href="https://fonts.googleapis.com/css?family=Lato|Source+Code+Pro" rel="stylesheet">-->
<!--<link href="https://fonts.googleapis.com/css?family=Open+Sans:300" rel="stylesheet">-->
<link href="https://fonts.googleapis.com/css?family=Cairo:300" rel="stylesheet">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<nav class="header-nav">
    <ul class="header-nav__container--left">
        <li class="header-nav__item--logo">
            <a href="/">
                <img src="/images/mocklab_logo_transparent.png" title="MockLab logo"/>
            </a>
        </li>
    </ul>

    <ul class="header-nav__container--right">



        <li class="header-nav__item header-nav__item--login">
            <a href="https://app.mocklab.io/login" title="Log in">Log in</a>
        </li>

    </ul>
</nav>


    

<div id="main" role="main">
  


<div class="sidebar sticky">
  <nav class="nav__list">

    <ul>
      

      
      <li>
        <a href="/docs/getting-started/">

        Getting Started
      </a>
      
      <li>
        <a href="/docs/stubbing/">

        Stubbing responses
      </a>
      
      <li>
        <a href="/docs/advanced-stubbing/">

        Advanced Stubbing
      </a>
      
      <li>
        <a href="/docs/response-templating/">

        Response Templating
      </a>
      
      <li>
        <a href="/docs/automated-testing-with-java/">

        Automated Testing with Java
      </a>
      
      <li>
        <a href="/docs/recording-stubs/">

        Recording Stubs
      </a>
      
      <li>
        <a href="/docs/default-responses/">

        How to: Serve a Default Response
      </a>
      
      <li>
        <a href="/docs/soap-stubbing/" class="nav__list-item--selected">
        

        How to: Stub a SOAP response
      </a>
      
      <li>
        <a href="/docs/exploratory-testing-tutorial/">

        Tutorial: Exploratory Testing a Web App
      </a>
      
      <li>
        <a href="/docs/provisioning/">

        API Reference: Provisioning
      </a>
      
      <li>
        <a href="/docs/mocking/">

        API Reference: Mocking
      </a>
      
      <li>
        <a href="/docs/terms-and-conditions/">

        MockLab Terms of Service
      </a>
      
    </ul>
  </nav>
</div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="How to: Stub a SOAP response">
    <meta itemprop="description" content="Stubbing a SOAP response is similar in most respects to stubbing a REST response. The main difference is that the HTTP methodand URL alone are not enough to differentiate requests, since SOAP relies on XML in the request body to indicate the action to betaken and parameters/data.">
    <meta itemprop="datePublished" content="September 13, 2017">
    

    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">How to: Stub a SOAP response
</h1>
      </header>

      <section class="page__content" itemprop="text">
        <p>Stubbing a SOAP response is similar in most respects to stubbing a REST response. The main difference is that the HTTP method
and URL alone are not enough to differentiate requests, since SOAP relies on XML in the request body to indicate the action to be
taken and parameters/data.</p>

<p>MockLab stubs can be configured to match incoming request bodies using a variety of operators. The two of interest when working with SOAP are
<code class="highlighter-rouge">equalToXml</code> and <code class="highlighter-rouge">matchesXPath</code>.</p>

<h2 id="using-equaltoxml">Using equalToXml</h2>

<p>When dealing with request bodies that are small and have no data of a transient nature (transaction IDs and todayâ€™s date being examples of this)
<code class="highlighter-rouge">equalToXml</code> is a straightforward way to specify a match.</p>

<p>For instance given a SOAP service for managing a to do list, you may wish to mock an interaction matching a specific request to add an item:</p>

<p><img src="/images/screenshots/soap-request.png" title="SOAP request" /></p>

<p>Which returns a specific response:
<img src="/images/screenshots/soap-response.png" title="SOAP response" /></p>

<p>Testing this returns the expected XML response:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ curl -X POST -d '&lt;?xml version="1.0"?&gt;
&lt;soap-env:Envelope xmlns:soap-env="http://www.w3.org/2001/12/soap-envelope" soap-env:encodingStyle="http://www.w3.org/2001/12/soap-encoding"&gt;

   &lt;soap-env:Body xmlns:m="http://example.company/todo" &gt;
      &lt;m:AddToDoItem&gt;
         &lt;m:ToDoItem&gt;Have a wash&lt;/m:ToDoItem&gt;
      &lt;/m:AddToDoItem&gt;
   &lt;/soap-env:Body&gt;

&lt;/soap-env:Envelope&gt;' -H 'SOAPAction: "http://example.company/todo/AddToDoItem"' http://example.mocklab.io/soap-example -v

&gt; POST /soap-example HTTP/1.1
&gt; Host: example.mocklab.io
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt; SOAPAction: "http://example.company/todo/AddToDoItem"
&gt; Content-Length: 355
&gt; Content-Type: application/x-www-form-urlencoded
&gt; 
* upload completely sent off: 355 out of 355 bytes
&lt; HTTP/1.1 200 OK
&lt; Transfer-Encoding: chunked
&lt; 
&lt;?xml version="1.0"?&gt;
&lt;soap-env:Envelope xmlns:soap-env="http://www.w3.org/2001/12/soap-envelope" soap-env:encodingStyle="http://www.w3.org/2001/12/soap-encoding"&gt;

   &lt;soap-env:Body xmlns:m="http://example.company/todo" &gt;
      &lt;m:AddToDoResult&gt;Item "Have a wash" successfully added&lt;/m:AddToDoResult&gt;
   &lt;/soap-env:Body&gt;
   
&lt;/soap-env:Envelope&gt;
</code></pre>
</div>

<p>Whereas if you make a request to a URL with no stub to match you will see the default <code class="highlighter-rouge">403</code> response.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ curl -v http://example.mocklab.io/examples/12222222

&gt; GET /examples/12222222 HTTP/1.1
&gt; Host: example.mocklab.io
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 403 Forbidden
&lt; Transfer-Encoding: chunked
&lt; 
Sorry, you can't do that
</code></pre>
</div>

<h2 id="using-matchesxpath">Using matchesXPath</h2>

<p>When working with large SOAP request bodies performance can suffer as full semantic XML document comparisons are fairly compute intensive.
In this instance it may be more efficient and faster to match specific elements within the document using XPath.</p>

<p>Another situation in which this may be necessary is when transient data appears in the request data, meaning it is never exactly the same
on more than one occasion.</p>

<p>The behaviour described above could also be achieved using <code class="highlighter-rouge">matchesXPath</code>:</p>

<p><img src="/images/screenshots/xpath-soap-match.png" title="Matching with XPath" /></p>

<blockquote>
  <p><strong>note</strong></p>

  <p>Note the XPath expression <code class="highlighter-rouge">//*[local-name() = 'ToDoItem' and text() = 'Have a wash']</code> uses <code class="highlighter-rouge">local-name()</code> in order to avoid having to
  declare the <code class="highlighter-rouge">m</code> namespace.</p>
</blockquote>


        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      
    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-copyright">&copy; 2017 MockLab.</div>

<div id="dialog" style="display: none">
  <h2 class="mocklab-popup__title">Looking for super-quick hosted mocks? Try MockLab</h2>
  <p>Instant mock services on your own public URL, zero code required. Paste, record and generate mock data. Tester-friendly UI.</p>
</div>

      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-78148205-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






  </body>
</html>

